
## Chapter 3

### Exercise 1

```{python}

import pandas as pd
import plotly.express as px

data = pd.Series(
    [0.04, 0.05, 0.20, 0.34, 0.53, 0.72, 0.94, 0.96, 0.99],
    index=pd.Index([2, 4, 6, 8, 10, 12, 14, 16, 18], name="Stimulus Intensity"),
    name="p(yes)",
)

px.line(data).add_hline(y=0.5, line_dash="dash")

```

### Exercise 2

```{python}

from scipy.stats import norm

z = pd.Series(norm.ppf(data), name='z', index=data.index)

px.line(z, y='z')

```

### Exercise 3

```{python}

df = pd.DataFrame(
    {
        "Comparison Stimulus": [60, 70, 80, 90, 100, 110, 120, 130, 140],
        "p greater": [.02, .08, .15, .30, .53, .68, .87, .91, .98]
    }
)

df['z'] = df['p greater'].apply(norm.ppf)

px.scatter(df, x="Comparison Stimulus", y='z', trendline='ols').show()
pd.DataFrame({"PSE":[100]})

```

### Exercise 4

```{python}

standard_stimulus = 100

# pd.DataFrame(
#     {
#         'Stimulus Intensity': [140, 135, 130, 125, 120, 115, 110, 105, 100, 95, 90, 85, 80, 75, 70, 65, 60],
#         "A"
#     }
# )


block_1 = pd.Series(["G"] + ["E"] * 6 + ["L"] * 5, index=[125, 120, 115, 110, 105, 100, 95, 90, 85, 80, 75, 70,], name="A")

block_2 = pd.Series(["G"] * 4 + ["E"] * 6 + ["L"], index=[135, 130, 125, 120, 115, 110, 105, 100, 95, 90, 85,], name="D")

block_3 = pd.Series(["G"] + ["E"] * 4 + ["L"] * 5, index=[115, 110, 105, 100, 95, 90, 85, 80, 75, 70,], name="A")

block_4 = pd.Series(["G"] * 5 + ["E"] * 7 + ["L"], index=[140, 135, 130, 125, 120, 115, 110, 105, 100, 95, 90, 85, 80], name="D")

pd.concat([block_1, block_2, block_3, block_4], keys=["A", "D", "A", "D"], names=["direction"])

T_U = pd.Series([122.5, 117.5, 112.5, 117.5, 127.5, 122.5], index=["A", "D"] * 3)

T_L = pd.Series([92.5, 87.5, 92.5, 82.5, 87.5, 77.5], index=["A", "D"] * 3)

pd.concat([T_U, T_L], keys=["T_U", "T_L"])

IU = 120-86.7

PSE = (120 + 86.7) / 2

MeanDL = 16.65

CE = 3.4

```

### Exercise 5

```{python}

standard_stimulus = 100

set_comparison_stimulus = [85, 105, 97, 95, 98, 105, 110, 98, 104, 82, 112, 95, 107, 109, 96, 65, 93, 102, 91, 108, 94, 108, 138, 79, 117, 98, 125, 102, 131, 94, 118, 99, 85, 100, 99, 135, 80, 73, 107, 104, 102, 115, 96, 120, 101, 88, 103, 67, 104, 94]

PSE = 100.66

CE = .66
DL = 15.18

```
